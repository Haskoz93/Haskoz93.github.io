import java.util.ArrayList;
import java.util.Collections;
import java.util.List;
import java.util.Scanner;

class Equipo {
    String nombre;
    int derrotas = 0;

    Equipo(String nombre) {
        this.nombre = nombre;
    }
}

public class TorneoDobleEliminacionManual {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        List<Equipo> equipos = new ArrayList<>();
        equipos.add(new Equipo("Iago"));
        equipos.add(new Equipo("Kevin"));
        equipos.add(new Equipo("Nahi"));
        equipos.add(new Equipo("Gaby"));
        equipos.add(new Equipo("Dani"));
        equipos.add(new Equipo("Alex"));

        List<Equipo> ganadores = new ArrayList<>(equipos);
        List<Equipo> perdedores = new ArrayList<>();

        System.out.println("Inicio del Torneo de Doble Eliminación\n");

        while (ganadores.size() > 1 || perdedores.size() > 1) {
            jugarRonda(ganadores, perdedores, scanner, "Bracket de Ganadores");
            if (!perdedores.isEmpty()) {
                jugarRonda(perdedores, new ArrayList<>(), scanner, "Bracket de Perdedores");
            }
        }

        // Gran final
        Equipo finalistaGanadores = ganadores.get(0);
        Equipo finalistaPerdedores = perdedores.get(0);
        Equipo campeon = jugarGranFinal(finalistaGanadores, finalistaPerdedores, scanner);

        System.out.println("\n¡El campeón del torneo es: " + campeon.nombre + "!");
        scanner.close();
    }

    private static void jugarRonda(List<Equipo> ganadores, List<Equipo> perdedores, Scanner scanner, String ronda) {
        System.out.println("\n" + ronda);
        List<Equipo> nuevosGanadores = new ArrayList<>();
        Collections.shuffle(ganadores);

        for (int i = 0; i < ganadores.size() - 1; i += 2) {
            Equipo e1 = ganadores.get(i);
            Equipo e2 = ganadores.get(i + 1);

            System.out.println(e1.nombre + " vs " + e2.nombre);
            System.out.print("¿Quién ganó? (" + e1.nombre + " o " + e2.nombre + "): ");
            String ganadorNombre = scanner.nextLine().trim();
            Equipo ganador = ganadorNombre.equalsIgnoreCase(e1.nombre) ? e1 : e2;
            Equipo perdedor = ganador == e1 ? e2 : e1;

            perdedor.derrotas++;
            nuevosGanadores.add(ganador);
            
            if (perdedor.derrotas < 2) {
                perdedores.add(perdedor);
            }
        }

        ganadores.clear();
        ganadores.addAll(nuevosGanadores);
    }

    private static Equipo jugarGranFinal(Equipo ganador, Equipo finalistaPerdedores, Scanner scanner) {
        System.out.println("\nGran Final");
        System.out.println(ganador.nombre + " vs " + finalistaPerdedores.nombre);
        System.out.print("¿Quién ganó la final? (" + ganador.nombre + " o " + finalistaPerdedores.nombre + "): ");
        String ganadorNombre = scanner.nextLine().trim();
        Equipo campeon = ganadorNombre.equalsIgnoreCase(ganador.nombre) ? ganador : finalistaPerdedores;

        if (campeon == finalistaPerdedores) {
            System.out.println("\nDesempate Final");
            System.out.println(ganador.nombre + " vs " + finalistaPerdedores.nombre);
            System.out.print("¿Quién ganó el desempate? (" + ganador.nombre + " o " + finalistaPerdedores.nombre + "): ");
            ganadorNombre = scanner.nextLine().trim();
            campeon = ganadorNombre.equalsIgnoreCase(ganador.nombre) ? ganador : finalistaPerdedores;
        }
        return campeon;
    }
}
